
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
      <title>Get a Quick Home Quote</title>

      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

      <link href='https://fonts.googleapis.com/css?family=Oswald%7COpen+Sans:400,300%7C' rel="stylesheet" type="text/css" />
      <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,300,700' rel="stylesheet" type="text/css" />

      <link href="/static/js/jquery/jscrollpane/css/jquery.jscrollpane.css" type="text/css" rel="stylesheet" media="all" />

      <link href="/static/js/jquery-ui.min.css" rel="stylesheet" type="text/css"/>
      <link href="/static/css/cssreset-min.css" rel="stylesheet" type="text/css"/>

      <link href="/static/css/bs4/bootstrap.min.css" rel="stylesheet" media="screen" />

      <link href="/static/css/font-awesome.css" rel="stylesheet" type="text/css"/>

      <link href="/static/css/site.4.24.2018.css" rel="stylesheet" type="text/css"/>
      <link href="/static/css/style.4.24.2018.css" rel="stylesheet" type="text/css" media="all">

      <script src="/static/js/jquery.min.js" type="text/javascript"></script>
      <script src="/static/js/swipe.js" type="text/javascript"></script>
      <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAQwAGCqyyt16d1g-uVvD4LLoaBtqoqS_o&libraries=places" type="text/javascript"></script>

      <script src="/static/js/jquery/jscrollpane/jquery.jscrollpane.min.js" type="text/javascript" defer></script>
      <script src="/static/js/jquery/backstretch/jquery.backstretch.min.js" type="text/javascript" defer></script>
      <script src="/static/js/plugins.js" type="text/javascript" defer></script>
      <script src="/static/js/jquery.jpanelmenu.min.js" type="text/javascript" defer></script>

      {% if styles is defined %}
        <style type="text/css">
        {{ styles }}
        </style>
    {% endif %}
   </head>

   <body id="home-page">
       <div class="container">
           <script type="text/javascript">
           jQuery(document).ready(function ($) {
                $('#own_rent-0').on('click', function(){
                    $('#estimated_value').css('display', 'block');
                    $('#apartment_number').css('display', 'none');
                });
                $('#own_rent-1').on('click', function(){
                    $('#apartment_number').css('display', 'block');
                    $('#estimated_value').css('display', 'none');
                });

                $('#new_purchase-0').on('click', function(){
                    //show new_purchase_address
                    $('#new_purchase_address').css('display', 'block');
                });
                $('#new_purchase-1').on('click', function(){
                    //hide new_purchase_address
                    $('#new_purchase_address').css('display', 'none');
                });

                $('#married').on('click', function(){
                    if ($(this).attr('checked')) {
                        $('#spouse').css('display', 'block');
                    } else {
                        $('#spouse').css('display', 'none');
                    }
                });
            });
            // This example displays an address form, using the autocomplete feature
            // of the Google Places API to help users fill in the information.

            var geolocation = null;
            var circle = null;

            var placeSearch, autocomplete, autocomplete2;
            var componentForm = {
                street_number: 'short_name',
                route: 'long_name',
                locality: 'long_name',
                administrative_area_level_1: 'short_name',
                country: 'long_name',
                postal_code: 'short_name'
            };

            function initAutocomplete() {
                // Create the autocomplete object, restricting the search to geographical
                // location types.
                autocomplete = new google.maps.places.Autocomplete(
                /** @type {!HTMLInputElement} */(document.getElementById('autocomplete')),
                {types: ['geocode']});

                autocomplete2 = new google.maps.places.Autocomplete(
                /** @type {!HTMLInputElement} */(document.getElementById('autocomplete_new_purchase')),
                {types: ['geocode']});

                // When the user selects an address from the dropdown, populate the address
                // fields in the form.
                autocomplete.addListener('place_changed', fillInAddress);
                autocomplete2.addListener('place_changed', fillInAddress2);
            }

            function fillInAddress() {
                // Get the place details from the autocomplete object.
                var place = autocomplete.getPlace();

                for (var component in componentForm) {
                    document.getElementById(component).value = '';
                    document.getElementById(component).disabled = false;
                }

                // Get each component of the address from the place details
                // and fill the corresponding field on the form.
                for (var i = 0; i < place.address_components.length; i++) {
                    var addressType = place.address_components[i].types[0];
                    if (componentForm[addressType]) {
                        var val = place.address_components[i][componentForm[addressType]];
                        document.getElementById(addressType).value = val;
                    }
                }
            }

            function fillInAddress2() {
                // Get the place details from the autocomplete object.
                var place2 = autocomplete2.getPlace();

                for (var component in componentForm) {
                    document.getElementById(component).value = '';
                    document.getElementById(component).disabled = false;
                }

                // Get each component of the address from the place details
                // and fill the corresponding field on the form.
                for (var i = 0; i < place2.address_components.length; i++) {
                    var addressType = place2.address_components[i].types[0];
                    if (componentForm[addressType]) {
                        var val = place2.address_components[i][componentForm[addressType]];
                        document.getElementById(addressType).value = val;
                    }
                }
            }

            // Bias the autocomplete object to the user's geographical location,
            // as supplied by the browser's 'navigator.geolocation' object.
            function geolocate() {
                initAutocomplete();

                //var l =  autocomplete.geometry.viewport;
                if (geolocation == null) {
                    if (circle == null) {
                        if (navigator.geolocation) {
                            navigator.geolocation.getCurrentPosition(function(position) {
                                geolocation = {
                                    lat: position.coords.latitude,
                                    lng: position.coords.longitude
                                };
                                circle = new google.maps.Circle({
                                    center: geolocation,
                                    radius: position.coords.accuracy
                                });
                                autocomplete.setBounds(circle.getBounds());
                            });
                        }
                    }
                }
            }
        </script>

    

    <div class="col-lg-6">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <ul>
                    {% for message in messages %}
                        <li>{{ message[1] }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}
        <form action="./home" method="POST">
            <!-- Start of first page -->
            <div data-role="page" id="new_purchase_page">

                    <div data-role="header">
                        <h1>Foo</h1>
                    </div><!-- /header -->
                
                    <div role="main" class="ui-content">
                        <p>I'm first in the source order so I'm shown as the page.</p>
                        <p>View internal page called <a href="#bar">bar</a></p>
                    </div><!-- /content -->
                
                    <div data-role="footer">
                        <h4>Page Footer</h4>
                    </div><!-- /footer -->
                </div><!-- /page -->
                
                <!-- Start of second page -->
                <div data-role="page" id="bar">
                
                    <div data-role="header">
                        <h1>Bar</h1>
                    </div><!-- /header -->
                
                    <div role="main" class="ui-content">
                        <p>I'm the second in the source order so I'm hidden when the page loads. I'm just shown if a link that references my id is beeing clicked.</p>
                        <p><a href="#foo">Back to foo</a></p>
                    </div><!-- /content -->
                
                    <div data-role="footer">
                        <h4>Page Footer</h4>
                    </div><!-- /footer -->
                </div><!-- /page -->
            {{ form.csrf }}
            <input type="hidden" value="{{agent}}" id="agent" name="agent">

            <div class="form-check">
                {{ form.new_purchase }}
            </div>

            <div id="new_purchase_address">
                <div class="form-group mb-3">
                    {{ form.autocomplete_new_purchase.label }}
                    {{ form.autocomplete_new_purchase(class_="form-control col-lg-9", onFocus="geolocate()") }}
                    <div class="invalid-feedback">Your new address is required.</div>
                </div>

                <div class="form-group mb-3" id="estimated_value">
                    {{ form.newhomevalue.label }}
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">$</span>
                        </div>
                        {{ form.newhomevalue(class_="form-control col-lg-7") }}
                        <div class="invalid-feedback">The estimated value is required.</div>
                    </div>
                </div>
            </div>

            <div class="form-group mb-4">
                {{ form.autocomplete.label }}
                {{ form.autocomplete(class_="form-control col-lg-9", onFocus="geolocate()") }}
                <div class="invalid-feedback">Your current address is required.</div>
            </div>

            <div class="form-check">
                {{ form.own_rent }}
            </div>


            <div class="form-group mb-3">
                {{ form.email.label }}
                {{ form.email(class="form-control ") }}
                <small id="emailHelp" class="form-text text-muted">We require a valid email so that we can send you the quote.</small>
                <div class="invalid-feedback">Please enter your email address.</div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="form-group">
                        {{ form.first_name.label }}
                        {{ form.first_name(class_="form-control") }}
                        <div class="invalid-feedback">What is your first name?</div>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        {{ form.last_name.label }}
                        {{ form.last_name(class_="form-control") }}
                        <div class="invalid-feedback">What is your last name?</div>
                    </div>
                </div>
            </div>

            <div class="form-group mb-3">
                {{ form.birthdate.label }}
                {{ form.birthdate(class_="form-control col-lg-5") }}
                <div class="invalid-feedback">Your birthdate is required.</div>
            </div>

            <div class="form-group mb-3">
                {{ form.married.label }}
                <div class="input-group col-9 col-lg-6">
                    {{ form.married(class_="form-control") }} <label for="married">Yes (or legal significant other)</label>
                </div>
            </div>

            <div id="spouse">
                <div class="row">
                    <div class="col">
                        <div class="form-group">
                            {{ form.spouse_first_name.label }}
                            {{ form.spouse_first_name(class_="form-control") }}
                            <div class="invalid-feedback">What is your spouse's first name?</div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            {{ form.spouse_last_name.label }}
                            {{ form.spouse_last_name(class_="form-control") }}
                            <div class="invalid-feedback">What is your spouse's last name?</div>
                        </div>
                    </div>
                </div>

                <div class="form-group mb-3">
                    {{ form.spouse_birthdate.label }}
                    {{ form.spouse_birthdate(class_="form-control col-lg-5") }}
                    <div class="invalid-feedback">The spouse's birthdate is required.</div>
                </div>
            </div>

            

            

            <!--<div class="form-check mb-3">-->
            <!--    <input id="renting" name="own_rent" value="rent" type="radio" class="form-check-input">-->
            <!--    <label for="renting" class="form-check-label">I am renting</label>-->
            <!--</div>-->



            <div class="form-group mb-3" id="estimated_value">
                {{ form.homevalue.label }}
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">$</span>
                    </div>
                    {{ form.homevalue(class_="form-control col-lg-7") }}
                    <div class="invalid-feedback">The estimated value is required.</div>
                </div>
            </div>
            <div class="form-group mb-3" id="apartment_number">
                {{ form.aptunit.label }}
                {{ form.aptunit(class_="form-control col-lg-3", placeholder="#") }}
            </div>

            

            

            <button type="submit" class="btn btn-primary">Continue</button>
        </form>
    </div>
    <span id="street_number"></span>
    <span id="route"></span>
    <span id="locality"></span>
    <span id="administrative_area_level_1"></span>
    <span id="country"></span>
    <span id="postal_code"></span>
    </div>

    {% if invalids is defined %}
        <script type="text/javascript">
            {% for i in invalids %}
                console.log(jQuery('#' + '{{i}}'));
                jQuery('#' + '{{i}}').addClass('is-invalid');
            {% endfor %}
        </script>
    {% endif %}

    </body>
</html>
